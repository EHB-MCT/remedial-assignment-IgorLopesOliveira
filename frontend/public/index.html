<!-- ...existing code... -->
<div id="wallet-container">
  <button id="wallet-button">ğŸ’° Balance: â‚¬100</button>
  <div id="wallet-dropdown" class="hidden">
    <p><strong>Balance:</strong> â‚¬<span id="wallet-balance">100</span></p>
    <p><strong>Transaction History:</strong></p>
    <ul id="transaction-list"></ul>
  </div>
</div>

<h1>ğŸŒ Market Resources</h1>
<div class="product-grid" id="productGrid"></div>

<div id="inventory-container">
  <h2>ğŸ—ƒï¸ Your Inventory</h2>
  <ul id="inventory-list"></ul>
</div>

<script>
const USER_ID = 'USER123'; // Replace with actual user logic

// Fetch and display products
fetch('http://localhost:8080/api/products')
  .then(res => res.json())
  .then(data => {
    const grid = document.getElementById('productGrid');
    grid.innerHTML = '';
    data.forEach(product => {
      const div = document.createElement('div');
      div.className = 'product';
      console.log('Product ID:', product._id);

      div.innerHTML = `
        <h3>${product.name}</h3>
        <p>${product.description}</p>
        <p class="price">ğŸ’° $${product.price}</p>
        <p class="qty">ğŸ“¦ ${product.quantity} in stock</p>
        <button onclick="buyProduct('${product._id}')">ğŸ›’ Buy</button>
      `;
      grid.appendChild(div);
    });
  });

// Fetch and display wallet
function loadWallet() {
  fetch(`http://localhost:8080/api/users/${USER_ID}/wallet`)
    .then(res => res.json())
    .then(data => {
      walletBtn.innerHTML = `ğŸ’° Balance: â‚¬${data.balance}`;
      walletBalanceSpan.textContent = data.balance;
      transactionList.innerHTML = '';
      data.transactionHistory.slice().reverse().forEach((entry) => {
        const li = document.createElement('li');
        li.textContent = `${entry.type.toUpperCase()}: ${entry.product} (${entry.type === 'buy' ? '-' : '+'}â‚¬${entry.total})`;
        transactionList.appendChild(li);
      });
    });
}

// Fetch and display inventory
function loadInventory() {
  fetch(`http://localhost:8080/api/users/${USER_ID}/inventory`)
    .then(res => res.json())
    .then(data => {
      const inventoryList = document.getElementById('inventory-list');
      inventoryList.innerHTML = '';
      data.forEach(item => {
        const li = document.createElement('li');
        li.innerHTML = `
          ${item.product.name} - Qty: ${item.quantity}
          <button onclick="sellProduct('${item.product._id}', 1)">Sell 1</button>
        `;
        inventoryList.appendChild(li);
      });
    });
}

// Buy product
function buyProduct(productId) {
  fetch(`http://localhost:8080/api/market/buy/${productId}`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      userId: 'USER123',
      quantity: 1
    })
  })
  .then(res => res.json())
  .then(data => console.log('âœ… Bought:', data))
  .catch(err => console.error('âŒ Fetch error:', err));
}


// Sell product
function sellProduct(productId, quantity) {
  fetch(`http://localhost:8080/api/market/sell/${productId}`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ userId: USER_ID, quantity })
  })
  .then(res => res.json())
  .then(data => {
    alert(data.success ? 'Sold!' : data.error);
    loadWallet();
    loadInventory();
  });
}

// Wallet UI logic
const walletBtn = document.getElementById('wallet-button');
const walletDropdown = document.getElementById('wallet-dropdown');
const walletBalanceSpan = document.getElementById('wallet-balance');
const transactionList = document.getElementById('transaction-list');
walletBtn.addEventListener('click', () => {
  walletDropdown.classList.toggle('hidden');
});

// Initial load
loadWallet();
loadInventory();
</script>
<!-- ...existing code... -->